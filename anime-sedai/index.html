<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Anime 年代统计 | 1990-2025</title>
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="page">
    <header class="hero">
      <div>
        <p class="eyebrow">Anime Years 1990-2025</p>
        <h1>看看你跨越了多少年的动画</h1>
        <p class="lede">自动拉取 1990-2025 的动画数据，标记自己看过的作品，生成一张可分享的画像，类似 anime-sedai。</p>
        <div class="hero-actions">
          <button id="prefetchLight" class="btn primary">快速扫描 (每年 1 页)</button>
          <button id="prefetchDeep" class="btn ghost">深度扫描 (每年 4 页)</button>
        </div>
        <p class="hint">数据来自 Jikan / MyAnimeList，缓存到本地浏览器，避免重复请求。</p>
      </div>
      <div class="hero-card" id="heroStats">
        <div class="stat">
          <span>已加载</span>
          <strong id="statLoaded">0</strong>
          <small>条目</small>
        </div>
        <div class="stat">
          <span>已看过</span>
          <strong id="statWatched">0</strong>
          <small>部作品</small>
        </div>
        <div class="stat">
          <span>覆盖率</span>
          <strong id="statCoverage">0%</strong>
          <small>相对已加载</small>
        </div>
      </div>
    </header>

    <section class="controls">
      <div class="control-group">
        <label>年份</label>
        <select id="yearSelect">
          <option value="">全部</option>
        </select>
      </div>
      <div class="control-group">
        <label>类型</label>
        <select id="typeSelect">
          <option value="">全部</option>
          <option value="TV">TV</option>
          <option value="Movie">Movie</option>
          <option value="OVA">OVA</option>
          <option value="ONA">ONA</option>
          <option value="Special">Special</option>
        </select>
      </div>
      <div class="control-group search">
        <label>搜索标题</label>
        <input id="searchInput" type="search" placeholder="输入片名或别名关键词">
      </div>
      <div class="control-group slim">
        <label>状态</label>
        <select id="statusSelect">
          <option value="">全部</option>
          <option value="Finished Airing">完结</option>
          <option value="Currently Airing">连载</option>
          <option value="Not yet aired">未开播</option>
        </select>
      </div>
      <div class="control-group">
        <label>&nbsp;</label>
        <button id="fetchYearBtn" class="btn">拉取所选年份</button>
      </div>
      <div class="control-group progress">
        <label>进度</label>
        <div class="progress-bar">
          <div id="progressFill"></div>
        </div>
        <small id="progressText">等待开始</small>
      </div>
      <div class="control-group progress">
        <label>翻译进度</label>
        <div class="progress-bar">
          <div id="translateProgressFill"></div>
        </div>
        <small id="translateProgressText">暂无待翻译</small>
      </div>
    </section>

    <main class="layout">
      <section class="results">
        <header class="section-header">
          <div>
            <p class="eyebrow">查找结果</p>
            <h2>动画列表</h2>
            <p class="hint">点击卡片或“已看过”按钮即可标记，数据会保存在浏览器。</p>
          </div>
          <div class="section-actions">
            <button id="clearWatched" class="btn ghost small">清空已看记录</button>
            <button id="clearCache" class="btn ghost small">清空缓存数据</button>
          </div>
        </header>
        <div id="animeList" class="grid"></div>
        <p class="empty" id="emptyState">没有数据。先拉取一个年份或者执行快速扫描。</p>
      </section>

      <aside class="sidebar">
        <div class="card" id="shareCard">
          <div class="card-header">
            <p class="eyebrow">Share Card</p>
            <h3>我的跨年代动画画像</h3>
            <p class="muted">1990-2025 · 自动统计 · anime-sedai 风格</p>
          </div>
          <div class="card-body">
            <div class="share-stats">
              <div>
                <span>已看</span>
                <strong id="shareWatched">0</strong>
                <small>部</small>
              </div>
              <div>
                <span>覆盖率</span>
                <strong id="shareCoverage">0%</strong>
                <small>相对已加载</small>
              </div>
              <div>
                <span>最热年份</span>
                <strong id="shareHotYear">-</strong>
                <small>（已看数量）</small>
              </div>
            </div>
            <div class="mini-chart" id="shareYearBars"></div>
          </div>
        </div>
        <div class="card" id="shareTableCard">
          <div class="card-header">
            <p class="eyebrow">年份表格</p>
            <h3>动画世代表</h3>
            <p class="muted">按年份排布，绿色标记已看作品</p>
          </div>
          <div class="table-wrapper" id="shareTableContainer"></div>
        </div>
        <button id="downloadBtn" class="btn primary block">生成分享图 (PNG)</button>
        <p class="hint">截图区域为上方年份表格，你可以定制后再导出。</p>
      </aside>
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="main.js"></script>
</body>
</html>
